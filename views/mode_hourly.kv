##:set rgb_green hex_to_rgb("B4E5A2")
##:set rgb_yellow hex_to_rgb("FFFF8F")
##:set rgb_red hex_to_rgb("FF9B9B")
##:set rgb_blue hex_to_rgb("96DCF8")
##:set rgba_green 0.5,1,0.5,1
##:set rgba_yellow 1,1,0,1
##:set rgba_red 1,0.5,0.5,1
##:set rgba_blue 0.678,0.847,0.902,1

<Screen_Hourly>:
    #background with logos
    canvas.before:
        Color:
            rgba: app.rgba_green
        Rectangle:
            size: self.size
        Color:
            rgba: 1, 1, 1, 0.45      
        Rectangle:
            size: self.size
            source: 'assets/images/background_logos.png'
    #reset screen (clock) 
    on_pre_leave: self.ids.clock.reschedule_time_event()    
   
    #Homescreen Button
    Button:
        canvas:
            #Image
            Rectangle:
                pos: self.pos
                size: self.size
                source: "assets/images/button_home.png" 
            #countour            
            Color:
                rgba: 0, 0, 0, 1
            Line:
                width: dp(1.5)
                rectangle: self.x, self.y, self.width, self.height  
        size_hint: 0.10, 0.13
        pos_hint: {"top": 1, "right": 1}
        background_normal: ""
        background_color: 1, 1, 1, 1 
        on_release: root.manager.current = "homescreen"
    
    BoxLayout:
        #DEBUG
        #canvas.before:
        #    Color:
        #        rgba: app.rgba_yellow
        #    Rectangle:
        #        size: self.size
        #        pos: self.pos
        orientation: "horizontal"
        size_hint: 1, None
        height: root.ids.clock.minimum_height
        pos_hint: {"y": 0.4}
        padding: "30dp"
        spacing: "3dp"
        CircleButton:
            size_hint: 0.1, 0.8
            pos_hint: {"center_x": 0.35, "top": 1}
            icon: "assets/images/arrow_left.png"
            icon_size: 0.7
            on_release:
                root.decrement_hour()
        ClockWidget:
            id: clock
            on_displayed_time: rect_stack.update_hour(args[1])
            label_alignment: "center"
            date_fontsize: 21
            time_fontsize: 90
            size_hint: 0.4, None
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
        CircleButton:
            size_hint: 0.1, 0.8
            pos_hint: {"center_x": 0.65, "top": 1}
            icon: "assets/images/arrow_right.png"
            icon_size: 0.7
            on_release:
                root.increment_hour()
    
    #Consumption and Production Labels
    BoxLayout:
        orientation: "horizontal"
        size_hint: 1, 0.25
        pos_hint: {"center_x": 0.5, "top": 0.45}
        spacing: "40dp"
        padding: "10dp"
        
        LabelBox:
            title: "Production"
            value: 1000
        LabelBox:
            title: "Consumption"
            value: 2000

    RectStack:
        id: rect_stack
        pos_hint: {"x": 0, "y": 0}
        size_hint: 1, 0.15
        orientation: "horizontal"
        spacing: "3dp"
        padding: "3dp", 0

<CircleButton@Button>:
    id: circ_btn
    background_normal: ''
    background_color: 0, 0, 0, 0
    icon: ""
    icon_size: 1
    canvas.before:
        #white background
        Color:
            rgba: 1, 1, 1, 1
        Ellipse:
            size: self.size
            pos: self.pos
        #countour            
        Color:
            rgba: 0, 0, 0, 1
        Line:
            width: dp(2)
            ellipse: self.x, self.y, self.width, self.height       
   # Draw the icon
    Image:
        size_hint: None, None
        size: circ_btn.width * circ_btn.icon_size, circ_btn.height * circ_btn.icon_size
        pos: circ_btn.center_x - self.width / 2, circ_btn.center_y - self.height / 2
        source: circ_btn.icon

<RectangleWidget>
    canvas:
        Color:
            rgba: self.rect_color
        Rectangle:
            pos: self.pos
            size: self.size
        #countour            
        Color:
            rgba: 0, 0, 0, 1
        Line:
            width: dp(1)
            rectangle: self.x, self.y, self.width, self.height    

<LabelBox@BoxLayout>
    orientation: "vertical"
    color: 1,1,1,1
    padding: "5dp"
    spacing: "2dp"
    title: ""
    value: 0
    title_font_size: 25
    value_font_size: 25
    canvas.before:
        Color:
            rgba: self.color
        Rectangle:
            pos: self.pos
            size: self.size
        #countour            
        Color:
            rgba: 0, 0, 0, 1
        Line:
            width: dp(2)
            rectangle: self.x, self.y, self.width, self.height            
    Label:
        text: root.title
        font_name: "Aptos"
        font_size: root.title_font_size
        color: 0,0,0,1
        bold: True
        pos_hint: {"center_x": 0.5, "top": 1}
    Label:
        text: str(root.value)+" Wh"
        font_name: "Aptos"
        font_size: root.value_font_size
        color: 0,0,0,1
        pos_hint: {"center_x": 0.5, "y": 0}